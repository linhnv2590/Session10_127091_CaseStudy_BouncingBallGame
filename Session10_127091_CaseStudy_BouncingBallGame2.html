<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bouncing Ball Game</title>
</head>
<body>
<canvas id="myCanvas" style="border:1px solid #d3d3d3 " width="500" height="400"></canvas>
<script>
    var centerX = 50; // vi tri hien tai (ox)
    var centerY = 50; // vi tri hien tai(oy)
    var radius = 10; // ban kinh
    var boardX = 500; // chieu rong khung
    var boardY = 400; // chieu cao khung
    var ballDx = 3; // huong di
    var ballDy = 3; // huong di

    let Ball = function (ballDx, ballDy, radius) {
        this.ballDx = ballDx;
        this.ballDy = ballDy;
        this.radius = radius;

        this.drawBall = function () {
            let canvas = document.getElementById('myCanvas');
            let ctx = canvas.getContext("2d");
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            //ctx.clearRect(centerX - this.ballDx, centerY = centerY - this.ballDy, this.radius);

            centerX = centerX + this.ballDx;
            centerY = centerY + this.ballDy;

            ctx.beginPath();
            ctx.arc(centerX, centerY, this.radius, 0, Math.PI * 2, false);
            ctx.fill();

            if (centerY > boardY - this.radius || centerY - this.radius < 0) {
                this.ballDy = -1 * this.ballDy;
            }

            if (centerX > boardX - this.radius || centerX - this.radius < 0) {
                this.ballDx = -1 * this.ballDx;
            }
        }
    };

    function RectangleBar(left, top, width, height, speed) {
        this.left = left;
        this.top = top;
        this.width = width;
        this.height = height;
        this.speed = speed;

        this.createRectangleBar = function () {
            let canvas = document.getElementById("myCanvas");
            let ctx = canvas.getContext("2d");
            ctx.clearRect(0,0, canvas.width, canvas.height);
            // ctx.clearRect(this.left - this.speed, this.top, this.width, this.height);
            // ctx.clearRect(this.left + this.speed, this.top, this.width, this.height);
            ctx.fillRect(this.left, this.top, this.width, this.height);
        };
    }

    let ball = new Ball(ballDx, ballDy, radius);
    let bar = new RectangleBar(200, 300, 80, 20, 20);
    bar.createRectangleBar();


    function leftArrowPressed() {
        console.log(bar.left);
        if (bar.left >= 0) {
            bar.left -= bar.speed;
            bar.createRectangleBar();
        }
    }

    function rightArrowPressed() {
        console.log(bar.left);
        if (bar.left <= boardX - bar.width) {
            bar.left += bar.speed;
            bar.createRectangleBar();
        }
    }

    function moveSeclection(evt) {
        switch (evt.keyCode) {
            case 37:
                leftArrowPressed();
                break;
            case 39:
                rightArrowPressed();
                break;
        }
    }

    function docReady() {
        setInterval(ball.drawBall, 20);
        window.addEventListener('keydown', moveSeclection);
    }

    docReady();


</script>
</body>
</html>